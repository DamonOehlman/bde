#!/usr/bin/env node
var out = require('out'),
    nopt = require('nopt'),
    knownOpts = {
        'path': [String],
        'port': [Number],
        'suffix': [String]
    },
    shortHands = {
        'p': ['--port'],
        's': ['--suffix']
    },
    bde = require('../'),
    opts = nopt(knownOpts, shortHands, process.argv, 2);

// check for a raw port in the args
opts.port = opts.port || 
    (opts.argv && opts.argv.remain.length ? parseInt(opts.argv.remain[0], 10) : undefined);

bde(opts, function(err, backend) {
    if (err) return out('Unable to start bde: {0}', err);

    out('!{grey}bde server started on port: {0}', opts.port);
    out('!{grey}will browserify files matching: *-{0}.js', opts.suffix);

    // if a backend has been started also, then let the user know
    if (backend) {
        out('!{grey}backend started');
    }
});